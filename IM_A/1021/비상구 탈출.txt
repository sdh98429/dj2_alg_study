# 1번 비상구 탈출 01:31:16

제한 조건
 
실행시간 : 50개의 테스트 케이스를 합쳐서 C/C++의 경우 3초, JAVA의 경우 3초, Python 9초

메 모 리 : Heap, Global, Stack 등을 모두 합해 최대 256MB까지 사용 가능 (단, 스택은 최대 1MB까지 사용 가능)
 

제출 횟수 제한
 
제한 없음
 

채점
 
답안을 제출하면 결과를 판정해서 실시간으로 알려주며 그 의미는 다음과 같다.

Accept : 정상적으로 제출되었다는 의미 (컴파일 에러 등 없다는 의미이며 점수는 공개하지 않음)

Fail : 컴파일, 런타임 에러 등으로 0점
 

평가
 
sample_input은 편의를 위해 제공하며, 실제 채점은 별도의 평가용 input으로 이루어진다.

제한 시간 이내에 평가용 input의 모든 테스트 케이스에 대해 정답을 도출하면 Pass 이며,

그 외에 오답, 부분 정답, 시간 제한을 초과하는 경우 1회 Fail이 된다.
 



 




N*N 정사각형 크기를 가지는 공장이 있다. 공장에는 M으로 표시된 사람들과 E로 표시된 두 개의 비상구가 존재한다.
아래 그림 [Fig. 1]은 N=5인 공장에 사람들의 위치와 비상구의 위치를 표시한 맵이다.




               




공장에 화재와 같은 위급상황이 발생하면 각각의 사람들은 두 비상구 중 한 곳으로 신속히 탈출을 해야 한다.
모든 사람들이 최대한 빠른 시간 안에 탈출하는 것이 중요하며, 탈출에 소요되는 시간은 다음과 같이 이동 시간과 탈출 시간 2가지가 존재한다.




1. 이동 시간
 - 사람이 맵에 표시된 위치에서 비상구까지 이동하는데 걸리는 시간으로 다음과 같이 가로 세로 거리 차의 합으로 계산한다.


       이동 시간(초) = | MRow - ERow | + | MCol - ECol |

   (MRow, MCol : 사람 M의 세로위치, 가로위치, ERow, ECol : 비상구 E의 세로위치, 가로위치)

 - 예를 들어 그림 [Fig. 1]에서 사람 M1(3,1)이 비상구 E2(4,2)로 이동하는데 걸리는 이동 시간은,
     이동 시간(초) = | 3 - 4 | + | 1 - 2 | = 2  가 된다.




2. 탈출 시간
 - 비상구에 도착한 사람은 1초에 한 명씩 완강기 밧줄을 타고 안전한 지상으로 탈출을 할 수 있다.
  - 만약 동시에 비상구에 여러 명의 사람이 도착하거나, 이미 비상구에 도착하여 기다리는 사람이 있는 경우, 1초에 한 명씩만 탈출이 가능하다.
  - 예를 들어 그림 [Fig. 1]에서 사람 M1과 M2는 2초후에 동시에 E2에 도착할 수 있다.
   이 경우 한 명은 완강기를 타고 바로 1초뒤에 탈출이 가능하지만, 다른 한 명은 앞 사람의 탈출을 기다린 후 다시 1초뒤에 탈출 완료가 가능하다.
   즉, 최종적으로 M1과 M2 모두가 탈출을 완료할 때까지 필요한 시간은 4초가 된다.







사람 및 비상구가 표시된 N*N 크기의 맵이 주어졌을 때,
모든 사람들이 탈출했을 때의 시간이 최소가 되는 경우를 찾고, 그때의 소요시간을 출력하는 프로그램을 작성하라.





예를 들어, 아래의 [Fig. 2]와 같이 N=5인 맵이 주어진 경우를 살펴보자.






위급상황이 발생하면 모든 사람들은 E1, E2 두 개의 비상구 중 한 곳으로 탈출을 해야 한다.




1. M1과 M2는 E1로 이동하는데 2초가 걸린다. 그리고 탈출을 위한 완강기 이용은 1초에 1명씩만 가능하므로,
   M1이 먼저 탈출할 경우 총 3초뒤 탈출성공, 이후 M2가 총 4초 뒤 탈출에 성공한다.
2. M3는 E2로 이동하는데 1초, 완강기를 이용해 탈출하는데 1초가 걸리므로 총 2초뒤 탈출에 성공한다.
3. M4는 E1로 탈출할 경우, 3초뒤에 E1에 도착하지만, 이미 M1과 M2가 4초가 될 때까지 완강기를 사용한다. 따라서 총 5초가 될 때 탈출에 성공 할 수 있다.
    반면, M4가 E2로 탈출할 경우, 3초뒤에 E2에 도착하여, 바로 완강기를 이용해 1초 뒤인 총 4초만에 탈출에 성공 할 수 있다.




위의 예제에서 가장 늦게 탈출한 사람은 M2와 M4로, 위급상황 발생 이후 총 4초 뒤에 탈출에 성공할 수 있다. 따라서 위 예제의 정답은 4가 된다.

(가까운 탈출구로 탈출하는 것이 최적의 답이 되지 않는 경우가 있음에 유의하라.)






[제약사항]

1. 공장 한 변의 길이 N은 4 이상 10 이하의 정수. (4 ≤ N ≤ 10)
 2. 맵에 주어지는 사람의 수는 1 이상 10 이하의 정수. (1 ≤ 사람의 수 ≤ 10)
 3. 맵에 주어지는 비상구의 수는 반드시 2개 이다.




[입력]

입력의 맨 첫 줄에는 총 테스트 케이스의 개수 T가 주어지고, 그 다음 줄부터 T개의 테스트 케이스가 주어진다.
 테스트 케이스의 첫 번째 줄에는 공장 한 변의 길이 N이 주어지고, 그 다음 줄부터 N*N 크기의 맵 정보가 주어진다.
 맵에서 1은 사람을, 2는 비상구를 나타낸다. 




[출력]

출력은 "#t"를 찍고 한 칸 띄운 다음 정답을 출력한다. (t는 테스트 케이스의 번호를 의미하며 1부터 시작한다.)
 정답은 모든 사람들이 탈출에 성공 가능한 최소 시간이다.




[입출력 예]


입력 예
 

5

5

0 0 1 0 1

0 0 0 2 0

0 0 0 0 0

0 0 1 0 1

0 0 2 0 0

6

0 0 1 0 0 0

0 2 1 0 0 0

1 1 1 0 0 0

0 0 0 0 0 0

0 0 0 0 2 1

0 0 0 0 1 1

…
 
//총 테스트 케이스 개수 T=5

//첫 번째 테스트 케이스, N=5

//맵 정보 (Fig.2와동일)

 

 

 

 

//두 번째 테스트 케이스, N=6

 

 

 

 

 

 

//나머지는 sample_input.txt 참조
 

 



출력 예
 

#1 4

#2 5

#3 7

#4 19

#5 7
 


